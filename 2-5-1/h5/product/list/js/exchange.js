function getList(e,t,s){void 0!=t&&void 0!=s?(e.pagecnt=t,e.pageno=s):(e.pagecnt=null,e.pageno=null);var o;o=/jihe/i.test(navigator.userAgent)?"/search/client/query":"/search/h5/query",$.ajax({type:"post",url:o,data:{data:JSON.stringify(e)},success:function(e){if(console.log(e),0==e.sc)if(getData=e.data,0==$(".item").length&&0==getData.length){if(1==button)var t="进行换宿",o="民宿预订",a="使用现金支付吧",l="/html/member/weixinMinSu/list.html";else if(2==button)var t="兑换商品",o="积分商城",a="购买吧",l="/html/market/integralMall.html?tags=%E7%A7%AF%E5%88%86%E5%95%86%E5%9F%8E";var n='<div class="blankPage"><img src="http://7xio74.com1.z0.glb.clouddn.com/enchangeList/exchangeList_none.png"><p class="tips">当前资产不足，无法'+t+'<br/>请通过<span>"'+o+'"</span><span>'+a+'</span></p><a href="'+l+'">'+o+"</button></div>";$("body").append(n),$(".scrollBot").hide().html("已经加载完")}else $.each(getData.result,function(e){var t,o=getData.result[e].productBaseInfo.productName,a=getData.result[e].productBaseInfo.imgList[0]+"?imageView2/1/w/312/h/200",l=getData.result[e].productBaseInfo.productPrice.showCyType,n=getData.result[e].productBaseInfo.productPrice.showCyCode,c=getData.result[e].productBaseInfo.productPrice.showCyUnit;t=void 0!=couponCode?getData.result[e].productBaseInfo.h5url+"&couponCode="+couponCode:getData.result[e].productBaseInfo.h5url,showTotalPrice=0==l||5==l?getData.result[e].productBaseInfo.productPrice.showTotalPrice/100:getData.result[e].productBaseInfo.productPrice.showTotalPrice;var i;i=0==l?'<div class="item"><img src="'+a+'"><div class="itemInfo"><h4 class="bnbName ellips">'+o+'</h4><p class="bnbDesc ellips"></p><p class="bnbPrice">'+n+showTotalPrice+"起</p></div></div>":2==button?'<div class="item"><img src="'+a+'"><div class="itemInfo"><h4 class="bnbName ellips">'+o+'</h4><p class="bnbDesc ellips">'+n+'</p><p class="bnbPrice">'+showTotalPrice+c+"</p></div></div>":'<div class="item"><img src="'+a+'"><div class="itemInfo"><h4 class="bnbName ellips">'+o+'</h4><p class="bnbDesc ellips">'+n+'</p><p class="bnbPrice">'+showTotalPrice+c+"起</p></div></div>",$(".items").append(i),/jihe/i.test(navigator.userAgent)?$(".item").eq(e+5*(s-1)).attr("title",t):$(".item").eq(e+5*(s-1)).attr("title",t.replace(/bnbDetail/,"bnbShare"))}),console.log(getData.result.length),s==getData.pageInfo.pageAmount?$(".scrollBot").html("已经加载完"):$(".scrollBot").html("加载更多"),$(".item").on("click",function(){sessionStorage.setItem("leave","1"),window.location.href=$(this).attr("title")})}})}function getRequest(){var e=window.location.search,t=new Object;if(e.indexOf("?")!=-1){var s=e.substr(1);strs=s.split("&");for(var o=0;o<strs.length;o++)t[strs[o].split("=")[0]]=decodeURI(strs[o].split("=")[1])}return t}var couponCode=getRequest().couponCode,button=getRequest().button;$(document).ready(function(){1==sessionStorage.getItem("leave")&&(sessionStorage.setItem("leave","0"),window.location.reload());var e=getRequest().assetType,t=getRequest().couponId,s=getRequest().hotelIds;console.log(s),"1"==button?($("title").html("换宿列表"),reqData=s==-2?{assetType:e,couponId:t,scopes:[{hotelTypes:[1],include:1},{include:1,objectType:[1]},{tags:["几何商户"],include:0},{exchFlag:1,include:1}],sorts:[{field:"pointsvalue",rule:"DESC"}],pagecnt:5,pageno:1}:{assetType:e,couponId:t,scopes:[{hotelTypes:[1],include:1},{include:1,objectType:[1]},{hotelIds:s.split(","),include:0},{exchFlag:1,include:1}],sorts:[{field:"pointsvalue",rule:"DESC"}],pagecnt:5,pageno:1}):"2"==button?($("title").html("换商品列表"),reqData={assetType:e,couponId:t,scopes:[{include:1,objectType:[30,40]},{include:0,priceType:0},{exchFlag:1,include:1}],sorts:[{field:"pointsvalue",rule:"DESC"}],pagecnt:5,pageno:1}):"0"==button?($("title").html("订房列表"),s==-1?(console.log(s),reqData={scopes:[{hotelTypes:[1],include:1},{include:1,objectType:[1]}],pagecnt:5,pageno:1}):reqData=s==-2?{scopes:[{hotelTypes:[1],include:1},{include:1,objectType:[1]},{tags:["几何商户"],include:1}],pagecnt:5,pageno:1}:{scopes:[{hotelTypes:[1],include:1},{include:1,objectType:[1]},{hotelIds:s.split(","),include:1}],pagecnt:5,pageno:1}):($("title").html("积分兑房"),reqData={assetType:e,scopes:[{hotelTypes:[1],include:1},{include:1,priceType:1},{include:1,objectType:[1]},{tags:["几何商户"],include:1}],pagecnt:5,pageno:1}),console.log(reqData),getList(reqData,5,1);var o=1;$(window).scroll(function(){var e=$(this).scrollTop(),t=$(document).height(),s=$(this).height();"已经加载完"!=$(".scrollBot").html()&&e+s==t&&(o++,getList(reqData,5,o))}),$("#navSearch").click(function(){window.location.href="/h5/findMinsu.html?button="+button})});