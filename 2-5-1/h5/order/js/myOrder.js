var a;$(document).ready(function(){var H={"pageno":1,"pagecnt":"8"};var I=1;if(sessionStorage.getItem("leaveOrderList")==1){I=sessionStorage.getItem("pageOrderList");var J=sessionStorage.getItem("htmlOrderList");a=sessionStorage.getItem("scrollTopOrderList");$(".contentWrap").html(J);$(window).scrollTop(a);sessionStorage.setItem("leaveOrderList","0");sessionStorage.setItem("pageOrderList",1);sessionStorage.setItem("htmlOrderList",'');sessionStorage.setItem("scrollTopOrderList",0);}else{orderList(H)};$(window).scroll(function(){var J=$(this).scrollTop();var K=$(document).height();var L=$(this).height();if($(".load").html()=="已经加载完"){return}else{if(J+L==K){I++;H.pageno=I;orderList(H)}}});function orderList(J){$.post('/order/h5/list',{data:JSON.stringify(J)},function(K){console.log(K);if(K.sc==0){for(var L=0;L<K.data.length;L++){var M=K.data[L].showCyAmount?K.data[L].showCyAmount:0;var N=K.data[L].showCyCode?K.data[L].showCyCode:"";var O=K.data[L].showCyType?K.data[L].showCyType:0;var P=K.data[L].showCyUnit?K.data[L].showCyUnit:"";if(O=="0"||O=="5"){M=M/100};if(O=="4"||O=="5"){N="礼券"};if(K.data[L].ordertype==2){$(".contentWrap").append(' <div class="card"><a class="tiao" href="/html/order/orderDetailN.html?orderid='+K.data[L].orderid+'&hotelid='+K.data[L].hotelId+'"></a><ul class="cardLeft"><li><p class="nameTit">'+K.data[L].ordername+'</p></li><li>入住：'+formatStrDate(new Date(parseInt(K.data[L].checkin)))+',离店：'+formatStrDate(new Date(parseInt(K.data[L].checkout)))+', '+K.data[L].nights+'晚<span class="orderStatus orderStatus2">'+K.data[L].statedesc+'</span></li><li>预定'+K.data[L].quantity+'间</li></ul><a class="cardRight">'+N+'<span>'+M+'</span>'+P+'</a></div>')};if(K.data[L].ordertype==4){var Q;if(K.data[L].producttype==7){Q="/html/order/orderDetailN.html?orderid="}else if(K.data[L].producttype==8){Q="/html/order/dealDetail.html?orderid="};$(".contentWrap").append(' <div class="card"><a class="tiao" href="'+Q+K.data[L].orderid+'&hotelid='+K.data[L].hotelId+'"></a><ul class="cardLeft dian"><li><p class="nameTit">'+K.data[L].ordername+'</p><span class="orderStatus orderStatus1">'+K.data[L].statedesc+'</span></li><li>'+formatStrYear(new Date(parseInt(K.data[L].createtime)))+'<p class="price">'+N+'<span>'+M+'</span>'+P+'</p></li></ul></div>')};if(K.data[L].ordertype==6){$(".contentWrap").append(' <div class="card"><a class="tiao" href="/html/order/orderDetailN.html?orderid='+K.data[L].orderid+'&hotelid='+K.data[L].hotelId+'"></a><ul class="cardLeft dian"><li><p class="nameTit">'+K.data[L].ordername+'</p><span class="orderStatus orderStatus1">'+K.data[L].statedesc+'</span></li><li>'+formatStrYear(new Date(parseInt(K.data[L].createtime)))+'<p class="price">'+N+'<span>'+M+'</span>'+P+'</p></li></ul></div>')}};if(K.data.length<8&&K.data.length>=0){$(".load").html("已经加载完")};if(K.data.length==0&&$(".card").length==0){$(".load").html(hasBackground('您还没有订单','30%'))}}})};$(".card a").live("click",function(){sessionStorage.setItem("leaveOrderList","1");sessionStorage.setItem("pageOrderList",I);sessionStorage.setItem("htmlOrderList",$(".contentWrap").html());sessionStorage.setItem("scrollTopOrderList",$(window).scrollTop())})});window.onload=function(){if(a&&a>0){$(window).scrollTop(a)}};function formatNum(H){return H.toString().replace(/^(\d)$/,"0$1")};function formatStrDate(H){switch(typeof H){case"string":H=H.split(/-|\//g);return H[0]+"-"+formatNum(H[1])+"-"+formatNum(H[2]);break;case"object":return formatNum(H.getMonth()+1)+"/"+formatNum(H.getDate());break}};function formatStrYear(H){switch(typeof H){case"string":H=H.split(/-|\//g);return formatNum(H[0])+"-"+formatNum(H[1])+"-"+formatNum(H[2]);break;case"object":return formatNum(H.getFullYear())+"/"+formatNum(H.getMonth()+1)+"/"+formatNum(H.getDate());break}}